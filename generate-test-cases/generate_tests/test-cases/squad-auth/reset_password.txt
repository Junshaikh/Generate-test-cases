Feature: Reset Password

  Scenario: Successful password reset with valid credentials
    Given User exists with email "test@example.com"
    And User has requested a password reset
    When User clicks the reset link in the email
    And User enters a new password "NewPassword123"
    And User confirms the new password "NewPassword123"
    And User submits the password reset form
    Then User should be redirected to the login page
    And User should see a success message "Your password has been reset successfully."
    And User should be able to login with the new password "NewPassword123"

  Scenario: Unsuccessful password reset with invalid credentials - mismatched passwords
    Given User exists with email "test@example.com"
    And User has requested a password reset
    When User clicks the reset link in the email
    And User enters a new password "NewPassword123"
    And User confirms the new password "DifferentPassword456"
    And User submits the password reset form
    Then User should see an error message "Passwords do not match."
    And User should remain on the password reset page
    And User should not be able to login with either "NewPassword123" or "DifferentPassword456"

  Scenario: Unsuccessful password reset with invalid credentials - weak password
    Given User exists with email "test@example.com"
    And User has requested a password reset
    When User clicks the reset link in the email
    And User enters a new password "weak"
    And User confirms the new password "weak"
    And User submits the password reset form
    Then User should see an error message "Password is too weak."
    And User should remain on the password reset page
    And User should not be able to login with the password "weak"

  Scenario: Unsuccessful password reset with invalid credentials - expired reset link
    Given User exists with email "test@example.com"
    And User has requested a password reset more than 24 hours ago
    When User clicks the reset link in the email
    And User enters a new password "NewPassword123"
    And User confirms the new password "NewPassword123"
    And User submits the password reset form
    Then User should see an error message "Password reset link has expired."
    And User should be redirected to the forgot password page
    And User should not be able to login with the new password "NewPassword123"

  Scenario: Unsuccessful password reset with invalid credentials - invalid reset link
    Given User does not exist with email "invalid@example.com"
    When User clicks a reset link with an invalid token
    And User enters a new password "NewPassword123"
    And User confirms the new password "NewPassword123"
    And User submits the password reset form
    Then User should see an error message "Invalid password reset link."
    And User should be redirected to the forgot password page
    And User should not be able to login with the new password "NewPassword123"

  Scenario: Unsuccessful password reset - attempt password reuse (already used password)
    Given User exists with email "test@example.com"
    And User has requested a password reset
    And User's previous password was "OldPassword123"
    When User clicks the reset link in the email
    And User enters a new password "OldPassword123"
    And User confirms the new password "OldPassword123"
    And User submits the password reset form
    Then User should see an error message "Password cannot be the same as your previous password."
    And User should remain on the password reset page
    And User should not be able to login with the password "OldPassword123"

  Scenario: User cannot reset password without requesting a reset link
    Given User exists with email "test@example.com"
    When User attempts to reset password directly from the reset page without requesting a link
    And User enters a new password "NewPassword123"
    And User confirms the new password "NewPassword123"
    And User submits the password reset form
    Then User should see an error message "Invalid request. Please request a password reset link."
    And User should be redirected to the forgot password page
    And User should not be able to login with the new password "NewPassword123"