Feature: Reset Password

  Scenario: Successful password reset
    Given the user "testuser" exists with email "testuser@example.com"
    And the user has requested a password reset
    When they enter the correct email address "testuser@example.com" and a valid reset token
    And they enter a new password "NewPassword123!" and confirm it
    Then the password reset should be successful
    And the user should be able to login with the new password "NewPassword123!"
    And the reset token should be invalidated

  Scenario: Password reset fails with incorrect email
    Given the user "testuser" exists with email "testuser@example.com"
    And the user has requested a password reset
    When they enter an incorrect email address "wrongemail@example.com" and a valid reset token
    And they enter a new password "NewPassword123!" and confirm it
    Then the password reset should fail with an error message indicating the email is incorrect
    And the user should not be able to login with the new password "NewPassword123!"

  Scenario: Password reset fails with invalid reset token
    Given the user "testuser" exists with email "testuser@example.com"
    And the user has requested a password reset
    When they enter the correct email address "testuser@example.com" and an invalid reset token "invalidToken"
    And they enter a new password "NewPassword123!" and confirm it
    Then the password reset should fail with an error message indicating the token is invalid
    And the user should not be able to login with the new password "NewPassword123!"

  Scenario: Password reset fails when passwords do not match
    Given the user "testuser" exists with email "testuser@example.com"
    And the user has requested a password reset
    When they enter the correct email address "testuser@example.com" and a valid reset token
    And they enter a new password "NewPassword123!" and confirm it with "DifferentPassword"
    Then the password reset should fail with an error message indicating the passwords do not match
    And the user should not be able to login with the new password "NewPassword123!"

  Scenario: Password reset fails with weak password
    Given the user "testuser" exists with email "testuser@example.com"
    And the user has requested a password reset
    When they enter the correct email address "testuser@example.com" and a valid reset token
    And they enter a new password "weak" and confirm it
    Then the password reset should fail with an error message indicating the password is too weak
    And the user should not be able to login with the new password "weak"

  Scenario: Reset token has expired
    Given the user "testuser" exists with email "testuser@example.com"
    And the user has requested a password reset more than 24 hours ago
    When they enter the correct email address "testuser@example.com" and a valid reset token
    And they enter a new password "NewPassword123!" and confirm it
    Then the password reset should fail with an error message indicating the token has expired
    And the user should not be able to login with the new password "NewPassword123!"