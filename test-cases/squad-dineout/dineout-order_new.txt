@P0 @smoke @login

Feature: Dine-out Order and Pay by Card

Background:
    Given User is logged in to the Talabat app
    And User has an active Pro subscription

Scenario: Successfully order and pay for a dine-out experience using a card
    Given User navigates to the "Dine-out" section
    When User selects a restaurant from the list
    And User views the restaurant's menu and selects items to order
    And User reviews the order summary
    And User chooses to pay with a saved card
    Then User should be able to confirm the order and payment successfully
    And User should receive an order confirmation notification
    And The order details should be displayed in the user's order history

Scenario: Successfully order and pay for a dine-out experience using a new card
    Given User navigates to the "Dine-out" section
    When User selects a restaurant from the list
    And User views the restaurant's menu and selects items to order
    And User reviews the order summary
    And User chooses to pay with a new card
    And User enters valid card details
    Then User should be able to confirm the order and payment successfully
    And User should receive an order confirmation notification
    And The order details should be displayed in the user's order history

Scenario: Order cancellation due to insufficient funds on card
    Given User navigates to the "Dine-out" section
    When User selects a restaurant from the list
    And User views the restaurant's menu and selects items to order
    And User reviews the order summary
    And User chooses to pay with a card
    And User attempts payment with a card that has insufficient funds
    Then The payment should be declined
    And User should receive an error message indicating insufficient funds
    And User should be prompted to choose another payment method

Scenario: Adding a tip during dine-out order and paying with a card
    Given User navigates to the "Dine-out" section
    When User selects a restaurant from the list
    And User views the restaurant's menu and selects items to order
    And User reviews the order summary
    And User adds a tip to the order
    And User chooses to pay with a saved card
    Then User should be able to confirm the order and payment successfully including the tip
    And User should receive an order confirmation notification showing the tip amount
    And The order details should be displayed in the user's order history with the tip included

Scenario: Verify Dine-out voucher application with card payment
    Given User navigates to the "Dine-out" section
    When User selects a restaurant from the list
    And User views the restaurant's menu and selects items to order
    And User reviews the order summary
    And User applies a valid Dine-out voucher
    And User chooses to pay with a saved card
    Then User should be able to confirm the order and payment successfully with the voucher discount applied
    And User should receive an order confirmation notification showing the voucher discount
    And The order details should be displayed in the user's order history with the voucher discount