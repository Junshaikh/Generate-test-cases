@P1 @smoke @regression

Feature: Charity Functionality

  Background:
    Given User is logged in with pro subscription

  Scenario: Donate to a charity through Give Back on the home screen
    Given User is on the Talabat home screen
    When User taps on the "Giveback" entry point
    Then User should navigate to the "Donate collection" screen
    When User chooses a vendor to donate to and adds it to the cart
    And User taps on "Donate Now"
    And User navigates to the cart
    And User taps on "Checkout"
    Then User should be able to choose a payment method such as "Talabat Credit Wallet"
    And User should see the payment summary with the total donation amount
    When User confirms the payment
    Then The donation should be processed successfully

  Scenario: Verify Giveback option on the home screen
    Given User is on the Talabat home screen
    Then User should see the "Giveback" entry point in the verticals

  Scenario: Verify Donation in Cart
    Given User is on the Talabat home screen
    When User taps on the "Giveback" entry point
    Then User should navigate to the "Donate collection" screen
    When User chooses a vendor to donate to and adds it to the cart
    And User navigates to the cart
    Then User should see the items added to the cart correctly with the correct price

  Scenario: Verify that user can pay with all payment methods
    Given User is on the Talabat home screen
    When User taps on the "Giveback" entry point
    Then User should navigate to the "Donate collection" screen
    When User chooses a vendor to donate to and adds it to the cart
    And User taps on "Donate Now"
    And User navigates to the cart
    And User taps on "Checkout"
    Then User should see available payment methods
    And User should be able to choose to pay using any available payment method such as saved card, new card, talabat credit wallet, postpaid, Google Pay, Apple Pay, or Cash
    When User confirm payment
    Then The donation should be processed successfully

  Scenario: Verify pro discount is applied in Giveback flow
    Given User is on the Talabat home screen
    When User taps on the "Giveback" entry point
    Then User should navigate to the "Donate collection" screen
    When User chooses a vendor to donate to and adds it to the cart
    And User taps on "Donate Now"
    And User navigates to the cart
    And User taps on "Checkout"
    Then User should see the payment summary with the total donation amount
    And User should see the pro discount if applicable based on amount reach the free delivery