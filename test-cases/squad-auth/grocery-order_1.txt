@P0 @smoke @login

Feature: Ordering Grocery as a Guest with Pro Subscription

Background:
    Given User is logged in to the Talabat app
    And User has a Pro subscription

Scenario: Guest user can view grocery vendors
    Given User is on the Talabat home screen
    When User taps on the "Grocery" icon
    Then User should be navigated to the grocery vendor list screen
    And User should see the "Search for products or stores" field
    And User should see the multi-basket icon
    And User should see the "All Supermarkets" swim lane
    And User should see the "Recommended Grocery Stores" section
    And User should see advertisement banners
    And User should see the "Browse All Stores" section with filters "Offers", "Under 30 mins", and "Pro"

Scenario: Guest user can search for grocery vendors
    Given User is on the grocery vendor list screen
    When User enters "Spinneys" in the "Search for products or stores" field
    Then User should see grocery vendors matching "Spinneys" in the search results

Scenario: Guest user can filter grocery vendors by "Offers"
    Given User is on the grocery vendor list screen
    When User taps on the "Offers" filter in the "Browse All Stores" section
    Then User should see grocery vendors that have available offers

Scenario: Guest user can filter grocery vendors by "Under 30 mins"
    Given User is on the grocery vendor list screen
    When User taps on the "Under 30 mins" filter in the "Browse All Stores" section
    Then User should see grocery vendors with delivery times under 30 minutes

Scenario: Guest user can filter grocery vendors by "Pro"
    Given User is on the grocery vendor list screen
    When User taps on the "Pro" filter in the "Browse All Stores" section
    Then User should see grocery vendors that offer benefits for Pro subscribers

Scenario: Guest user can navigate to a grocery vendor's catalog
    Given User is on the grocery vendor list screen
    When User taps on a grocery vendor card (e.g., "Spinneys")
    Then User should be navigated to the catalog screen for "Spinneys"

Scenario: Guest user can view a grocery vendor's catalog details
    Given User is on the catalog screen for "Spinneys"
    Then User should see the search icon
    And User should see the heart icon (favorites)
    And User should see the share icon
    And User should see the back button
    And User should see the grocery store name "Spinneys"
    And User should see the cuisine, ratings, delivery time, and delivery fee for "Spinneys"
    And User should see "Delivered by Talabat" or "Delivered by Store"
    And User should see "Free delivery with PRO" tag
    And User should see bank offers
    And User should see grocery menu categories

Scenario: Guest user can add items to the cart from the grocery catalog
    Given User is on the catalog screen for "Spinneys"
    When User taps on "Add" button for an item (e.g., "Milk")
    Then The "View Cart" button should be enabled
    And The added item (e.g., "Milk") should be displayed in the cart

Scenario: Guest user can navigate to the cart screen
    Given User is on the catalog screen for "Spinneys"
    And User has added items to the cart
    When User taps on the "View Cart" button
    Then User should be navigated to the cart screen

Scenario: Guest user can view items in the cart
    Given User is on the cart screen
    Then User should see the "Add items" button
    And User should see the added item (e.g., "Milk") with price and quantity
    And User should see the "Edit" option for each item

Scenario: Guest user can edit items in the cart
    Given User is on the cart screen
    When User taps on the "Edit" option for an item (e.g., "Milk")
    Then The item bottom sheet should be displayed with options to modify the item details

Scenario: Guest user can add a special request to an item
    Given User is editing an item in the cart
    When User enters "Extra cold" in the special request field
    Then The special request "Extra cold" should be saved for that item

Scenario: Guest user can enter a voucher code
    Given User is on the cart screen
    When User enters a valid voucher code in the voucher code field
    Then The voucher discount should be applied to the order

Scenario: Guest user can view the payment summary on the cart screen
    Given User is on the cart screen
    Then User should see the "Payment Summary" section
    And User should see the "Subtotal"
    And User should see the "Delivery Fee"
    And User should see the "Service Fee"
    And User should see the "Pro Discount" (if applicable)
    And User should see the "Total Amount"
    And User should see the "Free Delivery" tag (if Pro and conditions met)

Scenario: Guest user can proceed to checkout
    Given User is on the cart screen
    When User taps on the "Proceed to Checkout" button
    Then User should be navigated to the checkout screen

Scenario: Guest user can view the checkout screen details
    Given User is on the checkout screen
    Then User should see the delivery address with map
    And User should see the option to change or add a new address
    And User should see the estimated delivery time
    And User should see the rider tip option
    And User should see the "Pay with" options (Talabat Credit Wallet, Postpaid, Saved Cards, Add New Card, Cash)
    And User should see platform specific payment options
    And User should see the "Payment Summary" section
    And User should see the "Subtotal"
    And User should see the "Delivery Fee"
    And User should see the "Service Fee"
    And User should see the "Pro Discount" (if applicable)
    And User should see the "Total Amount"
    And User should see the "Free Delivery" tag (if Pro and conditions met)

Scenario: Guest user can select a payment method at checkout
    Given User is on the checkout screen
    When User selects "Cash" as the payment method
    Then "Cash" should be selected as the payment method

Scenario: Guest user can place an order with cash payment
    Given User is on the checkout screen
    And User has selected "Cash" as the payment method
    When User taps on the "Place Order" button
    Then User should see the order confirmation screen